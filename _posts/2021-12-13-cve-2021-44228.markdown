---
layout: post
title:  "CVE-2021-44228 (Log4Shell) — Field Notes from a Focused Web-App Review"
date:   2021-12-13 20:00:19 +0700
author: twseptian
pin: true
categories: [Infosec, CVE, Research]
tags: [cve, infosec]
---

## Introduction

In late 2021 I revisited one of our Java web applications to validate exposure to Log4Shell. My goal was pragmatic: verify if any user-controlled input was reaching Log4j without strict formatting or filters, and confirm whether JNDI lookups were still enabled at runtime. I approached the review as a short, repeatable exercise the dev team could replicate quickly across services.

---

## Summary of the Finding

The application’s request metadata—specifically HTTP headers and certain form fields—was logged verbatim by Log4j 2.14.1. Because JNDI lookups were enabled in that version, a crafted string using the ${jndi:…} pattern was evaluated during logging. Under default/legacy settings this opened a path to remote lookups and, in unsafe environments, code execution. The risk hinged on two factors: (1) untrusted data reaching the logger, and (2) a reachable naming endpoint (e.g., LDAP/HTTP) that the host could contact.

---

## Reproduction steps (tested on local instance)
> Performed only on a local test instance for verification and learning.
For information and setup, let’s navigate to my github repository <a href="https://github.com/twseptian/Spring-Boot-Log4j-CVE-2021-44228-Docker-Lab">Spring Boot Log4j - CVE-2021-44228</a>

## Links:
- <a href="https://www.lunasec.io/docs/blog/log4j-zero-day/">Log4Shell: RCE 0-day exploit found in log4j 2, a popular Java logging package</a>
- <a href="https://www.lunasec.io/docs/blog/log4j-zero-day/">PSA: Log4Shell and the current state of JNDI injection</a>
- <a href="https://mbechler.github.io/2021/12/10/PSA_Log4Shell_JNDI_Injection/">Log4Shell sample vulnerable application (CVE-2021-44228)</a>
- <a href="https://github.com/christophetd/log4shell-vulnerable-app">JNDIExploit Update (Dec 13th): The JNDIExploit repository has been removed from GitHub</a>